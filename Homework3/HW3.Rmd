---
title: "Multiple linear regression and binary logistic regression models"
author: "Abdellah AitElmouden | Gabriel Abreu |  Jered Ataky | Patrick Maloney"
date: "4/13/2021"
output:
  pdf_document: 
    latex_engine: xelatex
    
  
---
```{r include=FALSE}

knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}

library(corrplot)
library(tidyverse)
library(Hmisc)
library(PerformanceAnalytics)
library(mice)
library(gt)
library(DMwR2)
library(caret)
library(bnstruct)
library(VIM)
library(corrr)
library(gtsummary)
library(kableExtra)
library(naniar)
library(rpart)

```


## Data Exploration


```{r include=true}

#Import data 

raw_train_data <- read.csv("https://raw.githubusercontent.com/aaitelmouden/DATA621/master/Homework3/crime-training-data_modified.csv")
glimpse(train_data)

#Find any NA values in data
sum(is.na(train_data))


#train_data <- raw_train_data[-13]

```
\newpage




```{r echo=FALSE, message=FALSE, warning=FALSE}

# Summary table 


table1 <- tbl_summary(raw_train_data,
          statistic = list(all_continuous() ~ "{mean} ({sd}) {median} {min} {max}"), missing = "no") 
table1
```


Proportion of target among the data. 0 means the crime rate below the median crime rate while 1 is above the median crime rate.
```{r}
raw_train_data$target <- factor(raw_train_data$target)

raw_train_data %>% 
  ggplot(aes(x=target, y = ..prop.., group = 1)) + 
  geom_bar(fill = 'firebrick', color = 'black')  +
  geom_text(stat='count', aes(label=..count..), vjust=-1) + 
  xlab("Median Crime Rate") +
  ylab("Proportion") +
  ylim(0, 0.55)

```

```{r}
raw_train_data %>%
  dplyr::select(-chas) %>% 
  gather(key, value, -target) %>% 
  mutate(key = factor(key)) %>% 
  ggplot(aes(x = key, y = value)) +
  geom_boxplot(aes(fill = target)) +
  facet_wrap(~ key, scales = 'free', ncol = 3)
```
```{r}
raw_train_data %>%
  gather(key, value, -c(target)) %>%
  ggplot(aes(value)) +
  geom_histogram() +
  facet_wrap(~ key, scales = 'free', ncol = 3)

```




### Correlations among predictors and Variable Selection



```{r echo=FALSE, message=FALSE, warning=FALSE}

COR <- raw_train_data %>% 
  correlate() %>% 
  focus(target)
gt(COR)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
COR %>% 
  mutate(rowname = factor(term, levels = term[order(target)])) %>%  # Order by correlation strength
  ggplot(aes(x = rowname, y = target)) +
    geom_bar(stat = "identity") +
    ylab("Correlation with TARGET WINS") +
    xlab("Variables") + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+ ggtitle("Figure 4: Correlation Against Target Win")
```


```{r echo=FALSE, message=FALSE, warning=FALSE}

#pairwise.complete.obs ignores NA values and computes correlation on complete observations
#we might have to run these corrplots again after we handle the NA values
chart.Correlation(raw_train_data, histograme=TRUE, method= "pearson", use="pairwise.complete.obs")
```


```{r echo=FALSE, message=FALSE, warning=FALSE}
data.corr <- cor(train_data[-c(1)], use="pairwise.complete.obs")

corrplot(data.corr, type = "lower", method="square")
```


## Data Preparation


```{r echo=FALSE, message=FALSE, warning=FALSE}
train_data <- train_data[-11]
```



```{r echo=FALSE, message=FALSE, warning=FALSE}


par(mfrow=c(1,2))
gg_miss_upset(train_data, 
              nsets = 5,
              nintersects = NA)
gg_miss_case(train_data)+
  theme_classic()
```


## BUILD MODELS




## SELECT MODELS



\begin{center}
Mean (SD) Median Minimum Maximum 
\end{center}


